{% extends "base_generic.html"%}
{% load static %}

{% block title %}
ChaeBi | M-type 랭킹
{% endblock %}

{% block content %}

<div class="mtype-ranking-page container">
    <!-- 상단 탭 -->
    {% comment %} <div class="ranking-pannel row">
        <div class="mtype-ranking col-sm-6 selected">
            <h2>Mtype 랭킹</h2>
            <span>내 타입과 같은 사람들이 평가한 랭킹을 보여드려요</span>
        </div>
        <div class="keyword-ranking col-sm-6">
            <h2>keyword 랭킹</h2>
            <span>각 키워드에서 가장 인기 높은 상품을 보여드려요</span>
        </div>
    </div> {% endcomment %}

    <div class="d-flex ranking-top">
        <div class="p-2 ranking-header">
            <h2>내 타입({{currentUser.profile.survey_fk.mtype}})의 최적 생리대는?</h2>
            <span>나와 같은 월경타입의 사람들이 평가한 순위</span><br>
        </div>

        <div class="ml-auto p-2 row ranking-sub">
            <div class="col"><a href="#">타입별 랭킹찾기</a></div>
            <div class="col"><a href="#">M-Type 재검사</a></div>
        </div>
        
    </div>

    <div class="ranking-result">
        <ul style="list-style-type:none";>
        {% for product in products %}
            <li>
                <div class="d-flex">                    
                    <div class="p-2">{{ forloop.counter }}위</div>
                    <div class="p-2"><img src="{{product.image.url}}" alt=""/></div>
                    <div class="p-2 product-info">
                        <h3>{{ product.name }}</h3>
                        {{ product.price }}원 / {{ product.count }}개
                        <h5>자연유래도 {{ nature_friendly }}%</h5>
                    </div>
                    <div class="ml-auto p-2 score">{{ product.reviewsummary.total_score }}</div>
                </div>
            </li>
        {% empty %}
            <div class="no-result">
                <p> 검색 결과가 없습니다.</p>
            </div>
        {% endfor %}
        </ul>
    </div>
</div>


<script type="text/javascript">

    window.onload = function(){
        var pre_selected_item = document.querySelector('.ranking-pannel .mtype-ranking');                                        

        document.querySelectorAll('.ranking-pannel div').forEach(function(item){
            item.addEventListener('click', function(){
                select_pannel(item);
                pre_selected_item = item;

                if( item.classList.contains('mtype-ranking') ){
                    location.href = "{% url 'MtypeRanking' %}";
                }

                if( item.classList.contains('keyword-ranking') ){
                    location.href = "{% url 'KeywordRanking' %}";
                }

            });
            item.addEventListener('mouseover', function(){
                select_pannel(item);
            });
            item.addEventListener('mouseout', function(){
                select_pannel(pre_selected_item);
            });
        });                 
    }

    function select_pannel(selected_item){
        document.querySelectorAll('.ranking-pannel div').forEach(function(item){
            item.classList.remove('selected');
        });
        selected_item.classList.add('selected');
    }

</script>



{% endblock %}