{% extends "base_generic.html" %}

{% block content %}

<div>
    {% comment %} 탭이 들어갈 곳 {% endcomment %}
</div>

<div>
    <form action="{% url 'CompareSearch' %}" method="GET" id="compareSearchForm">
        <div>
            <input type="text" name="q" placeholder="{{user.best_pad}}"/>
            <input type="hidden" name="compareConditionList" value=""/> 
            <br/>
        </div>
        보다
        <div>        
            <div>
                <input type="checkbox" value="price">저렴한
                <input type="checkbox" value="absorbency">흡수력 좋은
                <input type="checkbox" value="comfort">촉감/착용감 좋은
                <input type="checkbox" value="nature_friendly">자연유래정도 높은
                <input type="checkbox" value="anti_odour">탈취성 좋은
                <input type="checkbox" value="sensitivity">피부 트러블 덜 나는
            </div>
        </div>
        제품 찾아주세요
        <input type="button" value="검색" id="compareSearchBtn"/>
    </form>    
</div>

{% if first_page == False %}
<div>
    <p>총 {{ product_list|length }}개의 상품이 검색되었습니다</p>
    <hr/> 
    <select>
        <option value="">정확도순</option>
    </select>
</div>
    
<div>
    <ul>
        {% for product in page_obj %}
        <li>
            <img src="{{product.product_fk.image.url}}" alt="제품 이미지"/>
                <p>{{ product.product_fk.hashtag_fk.name }}</p>
                <h2>{{ product.product_fk.name }}</h2>
                <h3>{{ product.product_fk.category }}</h3>
            </a>
        </li>
        {% empty %}
        <p>'{{searchedWord}}'에 해당하는 검색결과가 없습니다.</p> 
        {% endfor %}
    </ul>

</div>

{% comment %} pagination {% endcomment %}
<div class="pagination">
    <span class="step-links">
        {% if page_obj.has_previous %}
            <a href="?page=1{% if request.GET.compareConditionList %}&amp;compareConditionList={{request.GET.compareConditionList}}{% endif %}{% if request.GET.q %}&amp;q={{request.GET.q}}{% endif %}">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.compareConditionList %}&amp;compareConditionList={{request.GET.compareConditionList}}{% endif %}{% if request.GET.q %}&amp;q={{request.GET.q}}{% endif %}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if request.GET.compareConditionList %}&amp;compareConditionList={{request.GET.compareConditionList}}{% endif %}{% if request.GET.q %}&amp;q={{request.GET.q}}{% endif %}">next</a>
            <a href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.compareConditionList %}&amp;compareConditionList={{request.GET.compareConditionList}}{% endif %}{% if request.GET.q %}&amp;q={{request.GET.q}}{% endif %}">last &raquo;</a>
        {% endif %}
    </span>
</div>
{% comment %} pagination {% endcomment %}
{% endif %}

<script type="text/javascript">
    window.onload = function(){        
        document.getElementById('compareSearchBtn').onclick = function(){
            var form = document.getElementById('compareSearchForm');
            var checkList = document.querySelectorAll("input[type='checkbox']:checked");
            var checkListStr = "";

            if( checkList.length > 0 ){                
                checkList.forEach(function(ele){
                    checkListStr += ele.value + ",";
                });
                checkListStr = checkListStr.substring(0, checkListStr.length - 1);
            }

            form.compareConditionList.value = checkListStr;
            form.submit();     
        }
    }
</script>

{% endblock %}



